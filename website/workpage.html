<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Light Hacks Workspace</title>
    <link rel="stylesheet" href="stylesclean.css">
    <link rel="icon" type="image/x-icon" href="./images/faviconsmall.png">
     <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
</head>
<body id="workspacepage">
    <nav id="navbar"></nav>
    <header style="background-color: hsla(217, 100%, 7%, 0.89);">
        <div class="left">
            <img src="./images/favicon.png" id="logo">
            <h3>Light Hacks</h3>
        </div>
        <div class="right">
            <h4>Projects</h4>
            <h4>Ideas</h4>
            <h4>Profile</h4>
        </div>
    </header>
    <nav id="navbarwhite"></nav>

    <div id="flexcontainer">
        <!-- Left panel: blocks -->
        <div id="blocksPanel">
            <span class="setColorBlock" draggable="true">
                light <input class="setColorBlockPinNum" placeholder="ID">
                set color <input class="setColorBlockColorInput" placeholder="(r,g,b)">
            </span>

            <span class="setAllColorBlock" draggable="true">
                ALL lights color <input class="setAllColorBlockInput" placeholder="(r,g,b)">
            </span>

            <span class="turnOffBlock" draggable="true">
                turn off light <input class="turnOffBlockPinNum" placeholder="ID">
            </span>

            <span class="turnOffAllBlock" draggable="true">
                turn off ALL
            </span>

            <span class="setBrightnessBlock" draggable="true">
                light <input class="setBrightnessBlockPinNum" placeholder="ID">
                setBrightness <input class="setBrightnessBlockBrightnessInput" placeholder="%">
            </span>

            <span class="delayBlock" draggable="true">
                wait <input class="delayBlockTime" placeholder="ms">
            </span>

            <span class="repeatBlock" draggable="true">
                repeat this script
            </span>

            <!-- Set Variable Block -->
            <span class="setVarBlock" draggable="true">
                set <input class="setVarBlockName" placeholder="variable"> = 
                <input class="setVarBlockValue" placeholder="value">
            </span>

            <!-- Random Variable Block -->
             <span class="setRandomVarBlock" draggable="true">
                set random <input class="setRandomVarBlockName" placeholder="variable">
             </span>

            <!-- Change Variable Block -->
            <span class="changeVarBlock" draggable="true">
                +/- <input class="changeVarBlockName" placeholder="variable"> by 
                <input class="changeVarBlockValue" placeholder="value">
            </span>

            <!-- Multiply Variable Block -->
             <span class="multiplyVarBlock" draggable="true">
                multiply <input class="multiplyVarBlockName" placeholder="variable"> by
                <input class="multiplyVarBlockValue" placeholder="value">
             </span>

             <!-- Divide Variable Block -->
            <span class="divideVarBlock" draggable="true">
                divide <input class="divideVarBlockName" placeholder="variable"> by
                <input class="divideVarBlockName" placeholder="value">
            </span>

            <span class="rainbowBlock" draggable="true">
                rainbow preset
            </span>

            <!-- Update Block -->
            <span class="updateBlock" draggable="true">
                update
            </span>


            <button id="tutorialbutton">?</button>
               <!-- Tutorial Popup -->
                <div id="tutorialPopup">
                    <div id="tutorialContent">
                        <div class="tutorialStep active">
                            <h2>Welcome to Light Hacks!</h2>
                            <p>This tutorial will show you how to create a light project.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 1</h2>
                            <p>Drag and drop the blocks on the left to add them to your workspace.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 2</h2>
                            <p>The rightmost panel is where you define your *variables* which corresponds to specific LED bulbs.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 3</h2>
                            <p>Red blocks help with color: ID is the position of the light (0,1,2 etc.) and (r,g,b) asks for the Red, Green, Blue values of your color.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 4</h2>
                            <p>Blue blocks help with brightness and turning off lights at [ID] position.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 5</h2>
                            <p>Green blocks help with turning on lights at [ID] position to a brightness from 0-100%.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 6</h2>
                            <p>Yellow blocks help with timing. Use these to add delays between light changes.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Step 7</h2>
                            <p>Pink blocks allow you to change your variable incrementally or set it to a new value.</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>Fun Fact!</h2>
                            <p>You can use a white block for a fun preset pattern!</p>
                        </div>
                        <div class="tutorialStep">
                            <h2>All Done!</h2>
                            <p>Click Execute to run your project!</p>
                        </div>
                        <div class="tutorialButtons">
                            <button id="prevStep">Previous</button>
                            <button id="nextStep">Next</button>
                            <button id="closeTutorial">Close</button>
                        </div>
                    </div>
                </div>
            <button id="clearButton" onclick="clearButton()">Clear</button>
        </div>

        <!-- Workspace -->
        <div id="blockSpace">
            <button id="execute" onclick="executeRepeatedly()">Execute</button>
            <button id="saveButton" onclick="saveScript()">Save</button>
            <button id="loadButton" onclick="loadScript()">Load</button>
        </div>

        <!-- Variables panel -->
        <div id="variablesPanel">
            <h3>Variables</h3>
            <input id="newVarName" placeholder="Variable name">
            <button id="createVarBtn">Create Variable</button>
            <ul id="variablesList"></ul>
        </div>
    </div>
<script>

            document.addEventListener("DOMContentLoaded", () => {
            const openTutorialBtn = document.getElementById("tutorialbutton");
            const tutorialPopup = document.getElementById("tutorialPopup");
            const closeTutorialBtn = document.getElementById("closeTutorial");
            const steps = document.querySelectorAll(".tutorialStep");
            const nextBtn = document.getElementById("nextStep");
            const prevBtn = document.getElementById("prevStep");

            let currentStep = 0;

            openTutorialBtn.addEventListener("click", () => {
            tutorialPopup.style.display = "flex";
            currentStep = 0;
            showStep();
            });

            closeTutorialBtn.addEventListener("click", () => {
            tutorialPopup.style.display = "none";
            });

            nextBtn.addEventListener("click", () => {
            if (currentStep < steps.length - 1) currentStep++;
            showStep();
            });

            prevBtn.addEventListener("click", () => {
            if (currentStep > 0) currentStep--;
            showStep();
            });

            tutorialPopup.addEventListener("click", (e) => {
            if (e.target === tutorialPopup) tutorialPopup.style.display = "none";
            });

            function showStep() {
            steps.forEach((step, i) => {
                step.style.display = i === currentStep ? "block" : "none";
            });
            prevBtn.style.display = currentStep === 0 ? "none" : "inline-block";
            nextBtn.style.display = currentStep === steps.length - 1 ? "none" : "inline-block";
            closeTutorialBtn.style.display = currentStep === steps.length - 1 ? "inline-block" : "none";
        }
  });
        </script>

            <!-- Script -->
    <script src="script.js"></script>
</body>
</html>
